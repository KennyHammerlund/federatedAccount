{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/graphs/application/resolvers.js","webpack:///./src/graphs/delay/resolvers.js","webpack:///./src/graphs/game/resolvers.js","webpack:///./src/graphs/resolvers.js","webpack:///./src/index.js","webpack:///./src/server.js","webpack:///./src/utils/firebase.js","webpack:///external \"apollo-server\"","webpack:///external \"babel-runtime/core-js/object/keys\"","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"babel-runtime/helpers/asyncToGenerator\"","webpack:///external \"babel-runtime/helpers/classCallCheck\"","webpack:///external \"babel-runtime/helpers/createClass\"","webpack:///external \"babel-runtime/helpers/extends\"","webpack:///external \"babel-runtime/regenerator\"","webpack:///external \"firebase\"","webpack:///external \"firebase-admin\"","webpack:///external \"firebase/database\"","webpack:///external \"graphql-import\"","webpack:///external \"lodash\""],"names":["Query","summitUpload","obj","ctx","input","online","delay","arg","ref","docRef","child","once","then","snap","val","Mutation","setDelay","set","addDelay","callback","delayRef","res","rej","setTimeout","catch","application","game","id","gameRef","snapVal","keys","filter","k","name","actionIds","gameId","games","console","log","map","key","Game","actions","gameArr","includes","action","addGameAction","value","type","timeStamp","push","newRef","addGame","ApolloError","newItem","typeDefs","importSchema","PORT","server","ApolloServer","context","Context","req","resolvers","_","reduce","prev","next","merge","formatError","err","message","startsWith","AuthenticationError","replace","listen","port","url","request","headers","connection","email","validate","strippedEmail","db","re","test","String","toLowerCase","firebase","initializeApp","settings","database"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","export default {\n  Query: {\n    summitUpload: async (obj, { input }, ctx) => {\n      return {\n        online: true\n      };\n    }\n  }\n};\n","import db from \"../../utils/firebase\";\n\nexport default {\n  Query: {\n    delay: (obj, arg, { ref }) => {\n      let docRef = ref.child(\"delay\");\n      return docRef.once(\"value\").then(snap => snap.val());\n    }\n  },\n  Mutation: {\n    setDelay: (obj, { delay }, { ref }) => {\n      let docRef = ref.child(\"delay\");\n      docRef.set(delay);\n      return delay;\n    }\n  }\n};\n","import { ApolloError } from \"apollo-server\";\nconst addDelay = async (ref, callback) => {\n  const delayRef = ref.child(\"delay\");\n  const delay = await delayRef.once(\"value\").then(snap => snap.val());\n  return new Promise((res, rej) => {\n    setTimeout(\n      () =>\n        callback()\n          .then(res)\n          .catch(rej),\n      delay * 1000\n    );\n  });\n};\n\nexport default {\n  Query: {\n    application: async (obj, { input }, ctx) => {\n      return {\n        online: true\n      };\n    },\n    game: async (obj, { id }, { ref }) => {\n      const gameRef = ref.child(\"games\").child(id);\n\n      const snap = await gameRef.once(\"value\");\n      const snapVal = snap.val();\n      const keys = Object.keys(snapVal).filter(k => k !== \"name\");\n      return { name: snapVal.name, actionIds: keys, gameId: id };\n    },\n    games: async (obj, arg, { ref }) => {\n      const gameRef = ref.child(\"games\");\n      const snap = await gameRef.once(\"value\");\n      const snapVal = snap.val();\n      console.log(`*--snapVal`, snapVal);\n      if (!snapVal) return [];\n      return Object.keys(snapVal).map(key => ({\n        id: key,\n        ...snapVal[key]\n      }));\n    }\n  },\n  Game: {\n    actions: (obj, arg, { ref }) => {\n      if (!obj.actionIds) return null;\n      const gameRef = ref.child(\"games\").child(obj.gameId);\n      return gameRef.once(\"value\").then(snap => {\n        const snapVal = snap.val();\n        const gameArr = Object.keys(snapVal).map(key => ({\n          id: key,\n          ...snapVal[key]\n        }));\n\n        return gameArr.filter(action => obj.actionIds.includes(action.id));\n      });\n    }\n  },\n  Mutation: {\n    addGameAction: (obj, { input }, { ref }) => {\n      const { value, type, gameId, timeStamp } = input;\n      let docRef = ref\n        .child(\"games\")\n        .child(gameId)\n        .child(\"actions\");\n      return addDelay(ref, async () => {\n        const newRef = await docRef.push({\n          type,\n          value,\n          timeStamp\n        });\n\n        const snap = await docRef.once(\"value\");\n        const actions = snap.val();\n        return Object.keys(actions).map(k => ({ id: k, ...actions[k] }));\n      });\n    },\n    addGame: async (obj, { input }, { ref }) => {\n      let docRef = ref.child(\"games\");\n\n      const snap = await docRef.once(\"value\");\n      const games = snap.val();\n      Object.keys(games).map(k => {\n        if (games[k].name === input.name) {\n          console.log(`*--match`, games[k]);\n          throw new ApolloError(\n            \"There is already a game with this name\",\n            \"NO_DUPLICATE\"\n          );\n        }\n      });\n\n      const newItem = docRef.push({\n        name: input.name\n      });\n      return addDelay(ref, async () => ({\n        name: input.name,\n        id: newItem.key\n      }));\n    }\n  }\n};\n","export { default as game } from \"./game/resolvers\";\nexport { default as application } from \"./application/resolvers\";\nexport { default as delay } from \"./delay/resolvers\";\n","import server from './server'","import { importSchema } from \"graphql-import\";\nimport { ApolloServer, AuthenticationError } from \"apollo-server\";\nimport _ from \"lodash\";\nimport db from \"./utils/firebase\";\n\nimport * as resolvers from \"./graphs/resolvers\";\n\nconst typeDefs = importSchema(\"./src/graphs/schema.graphql\");\n\n// not required but can be useful if you run multiple servers.\nconst PORT = 2999;\n\nconst server = new ApolloServer({\n  typeDefs,\n  context: req => new Context(req),\n  resolvers: _.reduce(resolvers, (prev, next) => _.merge(prev, next)),\n  formatError: err => {\n    console.log(`*--err`, err);\n    if (err.message.startsWith(\"Context creation failed: \")) {\n      return new AuthenticationError(\n        err.message.replace(\"Context creation failed: \", \"\")\n      );\n    }\n    return err;\n  }\n});\n\n// Start accepting connections.\nserver.listen({ port: PORT }).then(({ url }) => {\n  console.log(`🚀 Apollo server running on port ${url}`);\n});\n\nclass Context {\n  constructor(request) {\n    const headers = request.req\n      ? request.req.headers\n      : request.connection.context;\n    this.email = headers && headers.email;\n    this.request = request.req;\n    this.validate(headers);\n    const strippedEmail = headers.email.replace(/[.\\#\\$]/g, \"--\");\n    this.ref = db.ref(strippedEmail);\n  }\n\n  validate(headers) {\n    if (!headers || !headers.email) {\n      throw new AuthenticationError(\"No Email Provided\");\n    }\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    if (!re.test(String(headers.email).toLowerCase())) {\n      throw new AuthenticationError(\"Email Malformed, must be a valid email\");\n    }\n  }\n}\n","import admin from \"firebase-admin\";\nimport settings from \"../../settings.json\";\nimport \"firebase/database\";\nimport firebase from \"firebase\";\n\nfirebase.initializeApp(settings.firebase);\n\nexport default firebase.database();\n","module.exports = require(\"apollo-server\");","module.exports = require(\"babel-runtime/core-js/object/keys\");","module.exports = require(\"babel-runtime/core-js/promise\");","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");","module.exports = require(\"babel-runtime/helpers/classCallCheck\");","module.exports = require(\"babel-runtime/helpers/createClass\");","module.exports = require(\"babel-runtime/helpers/extends\");","module.exports = require(\"babel-runtime/regenerator\");","module.exports = require(\"firebase\");","module.exports = require(\"firebase-admin\");","module.exports = require(\"firebase/database\");","module.exports = require(\"graphql-import\");","module.exports = require(\"lodash\");"],"sourceRoot":""}